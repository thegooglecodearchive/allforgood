<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>All for Good Online Spreadsheet</title>
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.2r1/build/fonts/fonts-min.css" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.2r1/build/calendar/assets/skins/sam/calendar.css" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.2r1/build/datatable/assets/skins/sam/datatable.css" />
<style type="text/css">
BODY {margin:20px;padding:0;
  background-color:#1755a0;
  background-repeat:repeat-x;
  background-image:url(assets/images/background.png);
}
TH {text-align:center;}
LABEL.ci {display:inline-block;width:100px;text-align:right;padding-right:5px;}
.rq {color:red;font-weight:bold;}
.yui-skin-sam .yui-dt-col-Description pre {font-family:arial;font-size:100%; }
.yui-skin-sam .yui-dt-liner { white-space:nowrap; } 
#commit {}
#bookmark {position:absolute;right:6px;top:6px;display:none;}
#logo {}
#wrapper {position:relative;width:1000px;padding:10px;padding-left:40px;padding-right:30px;background-color:#ffffff;text-align:left;}
#savers {text-align:right;}
#cellediting {}

/* Class for marked cols */
.yui-skin-sam .yui-dt td.mark,
.yui-skin-sam .yui-dt td.mark td.yui-dt-asc,
.yui-skin-sam .yui-dt td.mark td.yui-dt-desc,
.yui-skin-sam .yui-dt td.mark td.yui-dt-asc,
.yui-skin-sam .yui-dt td.mark td.yui-dt-desc {background-color: #a33;color: #fff;}
</style>
<script>
var CHANGED = false;
function exit() {
  if (CHANGED) {
    //goSave();
  }
}
</script>
</head>
<body class="yui-skin-sam" onunload="exit()">
<!--
<div id="logo">
<a href="http://www.allforgood.org/"><img border="none" src="assets/images/logo.gif" /></a>
</div>
-->
<center>
<div id="wrapper">
<h1>All for Good Volunteer Opportunity Spreadsheet</h1>
<div class="exampleIntro" style="position:relative;">
<p/>
Please use this spreadsheet form to submit your volunteer opportunities for inclusion in the All for Good search engine. Once submitted, you can update your spreadsheet as needed with new opportunities and make changes to previously submitted ones.  Once your spreadsheet has been submitted for processing, your opportunities normally will be included in the All for Good search results within 24 hours.  If you need technical assistance with the posting process please contact us at <a href="mailto:provider-support@allforgood.org">provider-support@allforgood.org</a>.
<p/>
If you have more than a few dozen listings you may wish to use the <a href="http://tinyurl.com/allforgood-submit">large spreadsheet submission tool</a>.
<p/>
By submitting your listings, you agree to the terms and conditions of All for Good as well as the 
<a href="http://www.allforgood.org/cla">Content License Agreement</a>.
</p>
<p>
<b>First enter your email address.</b> This is used to retrieve your previous listings and save new ones.
</p>
<form>
<table width="100%">
<tr>
<td>
<label class="ci" for="contact_email">Contact email:</label><input tabindex="1" onblur="goEmail(this);" id="contact_email" type="text" class="yui-ac-input"> 
<p/>
<!-- sponsor = Sponsoring Organization -->
<label class="ci" for="sponsor">Organization:</label><input tabindex="3" id="sponsor" type="text" class="yui-ac-input"> 
</td>
<td>
<label class="ci" for="contact_name">Contact name:</label><input tabindex="2" onfocus="chkEmail(this)" id="contact_name" type="text" class="yui-ac-input"> 
<p/>
<label class="ci" for="contact_phone">Contact phone:</label><input tabindex="4" id="contact_phone" type="text" class="yui-ac-input"> 
</td>
<td valign="top">
<input id="save" type="button" onclick="goSave();" value="Save" disabled />
</td>
<td style="width:460px;" valign="top">
<input type="hidden" id="committed" value="0" />
<input id="tos" type="checkbox" class="yui-ac-input" onclick="goTOS(this)">We agree to the <a href="http://www.allforgood.org/tos">terms of service</a>
<div id="commit_advice" style="display:none;">&nbsp;Any data found in this spreadsheet will be processed every 24 hours</div>
<div id="submit_advice" style="display:none;">
<p/>
<input id="commit" type="button" value="Submit for Processing" onclick="goCommit();" disabled />
Click the "Submit for Processing" button when to indicate these listings are ready to be processed.
</div>
</p>
</td></tr></table>
</form>
</div>
<div id="bookmark"><a href="javascript:void(0)" onclick="goBookmark(this)">Bookmark your spreadsheet</a></div>
</div> <!-- wrapper -->
</center>

<p/>
<input type="button" id="clear" style="visibility:hidden;" value="Delete selected rows" onclick="clearRows()" />
<p/>
<div id="cellediting"></div>
<p/>
<input type="button" value="Add 20 more rows" onclick="addRows(20)" />

<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/calendar/calendar-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/element/element-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/datasource/datasource-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/datatable/datatable-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/json/json-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/connection/connection-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/history/history-min.js"></script>

<script type="text/javascript" src="assets/js/data.js"></script>
<script type="text/javascript">
var DEBUG = false;
var CHANGED = false;

var myDataTable = null;
function json_safe(s) {
  var rtn = (s ? '' + s : '');
  return rtn.replace(/"/g, '\\"');
}

function _gel(id) {
  return document.getElementById(id);
}

function getValue(id) {
  var rtn = '';
  var it = _gel(id);
  if (it) {
    if (it.type == 'checkbox') {
      rtn = (it.checked ? 1 : 0);
    } else {
      rtn = (it.value || '');
    }
  }
  return rtn;
}

function setValue(id, val) {
  var it = _gel(id);
  if (it) {
    if (it.type == 'checkbox') {
      it.checked = (val == '1' ? true : false);
    } else {
      it.value = val;
    }
  }
}

function outputJSON() {
  var rtn = null;
  var ar = new Array();
  ar.push('{"Response":{');
  ar.push('"sponsor":"', json_safe(getValue('sponsor')), '",');
  ar.push('"tos":"', json_safe(getValue('tos')), '",');
  ar.push('"committed":"', json_safe(getValue('committed')), '",');
  ar.push('"contact_email":"', json_safe(getValue('contact_email')), '",');
  ar.push('"contact_name":"', json_safe(getValue('contact_name')), '",');
  ar.push('"contact_phone":"', json_safe(getValue('contact_phone')), '",');
  if (myDataTable) {
    ar.push('"Results":[');
    var rows = myDataTable.getRecordSet().getRecords();
    var data_rows = new Array();
    for (var row_idx in rows) {
      var cols = myDataTable.getColumnSet().keys;
      var num_cols = cols.length;
      var row = new Array();
      for (var col_idx in cols) {
        var key = cols[col_idx].getKey();
        var value = rows[row_idx].getData(key);
        num_cols--;
        if (key.indexOf('Date') >= 0 && value == 'Invalid Date') {
          value = '';
        }
        row.push('"', key, '":"', json_safe(value), '"');
        if (num_cols > 0) {
          row.push(',');
        }
      }
      data_rows.push('{' + row.join('') + '}');
    }
    if (data_rows.length > 0) {
      ar.push(data_rows.join(','));
    }
    ar.push(']');
  }
  ar.push('}}');
  rtn = ar.join('');
  return rtn;
}

function lz(s) {
  var rtn = s.toString();
  if (rtn && rtn.length < 2) {
    rtn = '0' + rtn;
  }
  return rtn;
}

YAHOO.widget.DataTable.formatDate = function(el, oRecord, oColumn, oData) {
  var oDate = oData;
  if(oDate && oDate instanceof Date) {
    var html = (lz(oDate.getMonth() + 1) + '/' + lz(oDate.getDate()) + '/' + oDate.getFullYear()).toString();
    if (html.indexOf('NaN') >= 0) {
      html = '';
    }
    el.innerHTML = html;
  }
};

function makeTable(data_url, data_object) {
  if (email_verified) {
    _gel('bookmark').style.display = 'block';
  }

  // Custom formatter for "description" column to preserve line breaks
  var formatDescription = function(elCell, oRecord, oColumn, oData) {
      elCell.innerHTML = "<pre class=\"Description\">" + (oData ? oData : '') + "</pre>";
  };

  var formatRowNumber = function(el, oRecord, oColumn, oData) {
    if (oData) {
      var html = new Array();
      html.push('<input onclick="goCheckRow(this)" type="checkbox" id="rchk', oData, '" />');
      html.push(oData);
      el.innerHTML = html.join('');
    }
  };

  var myColumnDefs = [
    {label:"#", key:"row",
       formatter:formatRowNumber
    },
    {label:"<span class='rq'>*</span>Opportunity<br/>Title", 
       key:"Opportunity_Title", minWidth:60, 
       editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})},
    {label:"<span class='rq'>*</span>Description", 
       formatter:formatDescription, minWidth:100,
       key:"Description", editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})
       },
    {label:"<span class='rq'>*</span>Website", key:"Website", 
       editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})},
    {label:"<span class='rq'>*</span>Location<br/>Name",key:"Location_Name", 
       minWidth:100,
       editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})},
    {label:"Address",key:"Location_number___street", 
       minWidth:100,
       editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})},
    {label:"<span class='rq'>*</span>City",key:"Location_city", 
       editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})},
    {label:"<span class='rq'>*</span>State",key:"Location_state___province", 
        editor: new YAHOO.widget.DropdownCellEditor({dropdownOptions:YAHOO.example.Data.stateAbbrs,
        multiple:false, disableBtns:false})},
    {label:"<span class='rq'>*</span>Postal<br/>Code",key:"Location_ZIP___postal_code", 
        editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})},
    {label:"Country", key:"Location_Country", editor: new YAHOO.widget.TextboxCellEditor({disableBtns:true})},
    {label:"Start<br/>Date",key:"Start_Date", formatter:YAHOO.widget.DataTable.formatDate, 
        editor: new YAHOO.widget.DateCellEditor({disableBtns:false})},
    {label:"End<br/>Date",key:"End_Date", formatter:YAHOO.widget.DataTable.formatDate, 
        editor: new YAHOO.widget.DateCellEditor({disableBtns:false})},
    {label:"How Often<br/>Event Repeats", key:"How_often_does_event_happen", 
        editor: new YAHOO.widget.DropdownCellEditor({multiple:false, disableBtns:false,
        dropdownOptions:["once","Daily","Weekly","Monthly"]})},
    {label:"Day of Week<br/>Event Repeats On", key:"Days_of_Week_Event_Repeats_On",
        editor: new YAHOO.widget.DropdownCellEditor({multiple:false, disableBtns:false,
        dropdownOptions:["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]})},
    {label:"Special<br/>Skills Needed",key:"Special_Skills_Needed", 
        editor: new YAHOO.widget.RadioCellEditor({radioOptions:["Yes","no"],disableBtns:true})}
  ];

  var myDataSource = null;
  if (!data_url) {
    if (!data_object) {
      for (var i = 0; i < 20; i++) {
        YAHOO.example.Data.blank.push(blank_row());
        YAHOO.example.Data.blank[i].row = (i + 1);
      }
      data_object = YAHOO.example.Data.blank;
    }
    myDataSource = new YAHOO.util.DataSource(data_object);
    myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSARRAY;
    myDataSource.responseSchema = {
      fields: ["row",
               "Opportunity_Title","Description",
               "Location_Name", "Location_number___street","Location_city",
               "Location state___province","Location_ZIP___postal_code","Location_Country",
               "Website",
               {key:"Start_Date",parser:"date"},
               {key:"End_Date",parser:"date"},
               "How_often_does_event_happen", "Days_of_Week_Event_Repeats_On",
               "Special_Skills_Needed"
              ]
    };
  } else {
    //  set the content-type to JSON
    myDataSource = new YAHOO.util.DataSource(data_url, {connMethodPost: true});
    myDataSource.connMgr = YAHOO.util.Connect;
    myDataSource.connMgr.initHeader('Content-Type', 'application/json; charset=utf-8', true);
    myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSON;            
    myDataSource.responseSchema = { 
       metaFields: {
        // oParsedResponse.meta.sponsor
        sponsor: "Response.sponsor",
        tos: "Reponse.tos",
        contact_email: "Response.contact_email",
        contact_name: "Response.contact_name",
        contact_phone: "Response.contact_phone"
      },
      resultsList: "Response.Results", 
           fields: ["row", 
                    "Opportunity_Title","Description",
                    "Location_Name", "Location_number___street","Location_city",
                    "Location_state___province","Location_ZIP___postal_code","Location_Country",
                    "Website",
                    {key:"Start_Date",parser:"date"},
                    {key:"End_Date",parser:"date"},
                    "How_often_does_event_happen", "Days_of_Week_Event_Repeats_On",
                    "Special_Skills_Needed"
                   ]
    }; 
  }

  myDataSource.doBeforeCallback = function(oRequest, oFullResponse, oParsedResponse, oCallback) {
    // globals
    setValue('sponsor', oFullResponse.Response.sponsor);
    setValue('contact_email', oFullResponse.Response.contact_email);
    setValue('contact_name', oFullResponse.Response.contact_name);
    setValue('contact_phone', oFullResponse.Response.contact_phone);
    setValue('tos', oFullResponse.Response.tos);
    setValue('committed', oFullResponse.Response.committed);
    showTOS();
    return oParsedResponse;
  };

  try {
    myDataTable = new YAHOO.widget.DataTable("cellediting", myColumnDefs, myDataSource, {});
  } catch(err) {
    alert(err.name.toString() + ':' + err.description);
  }

  var validInput = function(field, value) {
    var rtn = true;
    if (field == 'Opportunity_Title') {
      if (value.length < 10) {
        alert('Opportunity Title too short');
        rtn = false;
      }
    } else if (field == 'Description') {
      if (value.length < 10) {
        alert('Description too short');
        rtn = false;
      }
    } else if (field == 'Website') {
      if (value.length < 11 || value.toLower().indexOf('http://') < 0) {
        alert('Website invalid');
        rtn = false;
      }
    } else if (field.indexOf('Location_') >= 0) {
    }
   
    return rtn;
  };

  var markAddress = function(yes, oRecord) {
    var id = oRecord.getId();
    var it = _gel(id);
    if (it) {
      var ar = it.getElementsByTagName('td');
      for (var i in ar) {
        if (ar[i] && ar[i].className 
            && ar[i].className.indexOf('Location_') >= 0 
            && ar[i].className.indexOf('Location_Name') < 0) {
          if (yes) {
            YAHOO.util.Dom.addClass(ar[i], 'mark'); 
          } else {
            YAHOO.util.Dom.removeClass(ar[i], 'mark'); 
          }
        }
      }
    }
  };

  var verifyAddress = function(address, oRecord) {
    var url = "geo";
    var callback = {
      success:function(){markAddress(false, oRecord);},
      failure:function(){markAddress(true, oRecord);},
      argument: [url]
    };
    var json = outputJSON();
    var request = YAHOO.util.Connect.asyncRequest('POST', url, callback,
      'address=' + encodeURIComponent(address));
  };

  var onCellEdit = function(oArgs) {
    var oOldData = oArgs.oldData;
    var oNewData = oArgs.newData;
    if (oOldData == oNewData) {
      return true;
    }
    var key = oArgs.editor.getColumn().getField();
    if (key.indexOf('Location_') == 0 && key != 'Location_Name') {
      var oRecord = oArgs.editor.getRecord();
      var oRecData = oRecord.getData();
      //alert(YAHOO.lang.dump(oRecData));
      var state = (oRecData['Location_state___province'] || '');
      var city = (oRecData['Location_city'] || '');
      var street = (oRecData['Location_number___street'] || '');
      var zip = (oRecData['Location_ZIP___postal_code'] || '');
      var country = (oRecData['Location_Country'] || '');
      var address = street;
      address += (city ? (address.length > 0 ? ' ' : '') + city : '');
      address += (state ? (address.length > 0 ? ' ' : '') + state : '');
      address += (zip ? (address.length > 0 ? ' ' : '') + zip : '');
      address += (country ? (address.length > 0 ? ' ' : '') + country : '');
      if (zip || (city && state)) {
        verifyAddress(address, oRecord);
      }
    }
     
    if (!validInput(key, (oNewData || ''))) {
      myDataTable.updateCell(oArgs.editor.getRecord(), key, oOldData);
    } else if (oOldData != oNewData) {
      CHANGED = true;
      toggleSave();
    }
  }; 

  var highlightEditableCell = function(oArgs) {
    var elCell = oArgs.target;
    if(YAHOO.util.Dom.hasClass(elCell, "yui-dt-editable")) {
      this.highlightCell(elCell);
    }
  };

  if (myDataTable) {
    /* http://developer.yahoo.com/yui/docs/YAHOO.widget.DataTable.html */
    myDataTable.subscribe("editorSaveEvent", onCellEdit);
    myDataTable.subscribe("cellMouseoverEvent", highlightEditableCell);
    myDataTable.subscribe("cellMouseoutEvent", myDataTable.onEventUnhighlightCell);
    myDataTable.subscribe("cellClickEvent", myDataTable.onEventShowCellEditor);

    myDataTable.doBeforeShowCellEditor = function(oEditor) {
      if(!oEditor.disableBtns) {
        var oRecord = oEditor.getRecord();
        var oColumn = oEditor.getColumn();
        var it = this.getTdLinerEl({record:oRecord, column:oColumn});
        if (it) {
          it.innerHTML = '';
        }
        myDataTable.updateCell(oRecord, oColumn.getField());
        CHANGED = true;
        toggleSave();
      }
      return true;
    }
  }

  toggleSave();

  return {
      oDS: myDataSource,
      oDT: myDataTable
  };
}

var blank_row = function(){
    return {"row":"",
          "Opportunity_Title":"", "Description":"", "Website":"",
          "Location_Name":"", 
          "Location_number___street":"", 
          "Location_city":"", 
          "Location_state___province":"", 
          "Location_ZIP___postal code":"", 
          "Location_Country":"",
          "How_often_does_event_happen?":"", 
          "Days_of_Week_Event_Repeats_On":"",
          "Special_Skills_Needed":""
         };
}

function addRows(n) {
  if (myDataTable) {
    n = (n > 0 ? n : 20);
    var ar = new Array(); 
    var rows = myDataTable.getRecordSet().getLength(); 
    for (var i = 0; i < n; i++) {
      ar.push(blank_row());
      ar[i].row = (rows + i + 1);
    }
    myDataTable.addRows(ar);  
  }
}

function goCheckRow(inp) {
  var rtn = false;
  var ar = document.getElementsByTagName('input');
  for (var i in ar) {
    if (ar[i] && ar[i].id && ar[i].id.indexOf('rchk') == 0 && ar[i].checked) {
      rtn = true;
      break;
    }
  }
  showClearButton(rtn);
}

function clearRows() {
  if (email_verified) {
    if (confirm("Delete selected rows -- are you sure?\nThere is no undo")) {
      CHANGED = true;
      var list = new Array();
      var ar = document.getElementsByTagName('input');
      for (var i in ar) {
        if (ar[i] && ar[i].id && ar[i].id.indexOf('rchk') == 0 && ar[i].checked) {
          list.push(ar[i].id.substr(4));
          ar[i].checked = false;
        }
      }
      if (list.length > 0) {
        makeTable("clear?email=" + encodeURIComponent(email_verified) + '&rows=' + list.join(','));
      }
    }
  }
}

function showClearButton(yes) {
  var btn = _gel('clear');
  if (btn) {
    btn.style.visibility = (!CHANGED && yes ? 'visible' : 'hidden');
  }
}

function toggleSave() {
  var btn = _gel('save');
  if (btn) {
    if (CHANGED && email_verified) {
      showClearButton(false);
      btn.disabled = false;
    } else {
      btn.disabled = true;
    }
    btn.enabled = !btn.disabled;
  }
}

function saveOk(rsp) {
  CHANGED = false;
  toggleSave();
  if(rsp.responseText !== undefined){ 
    if (DEBUG) {
      var ar = new Array();
      ar.push("Transaction id: " + rsp.tId); 
      ar.push("HTTP status: " + rsp.status); 
      ar.push("Status code message: " + rsp.statusText); 
      ar.push("HTTP headers:",  rsp.getAllResponseHeaders);
      ar.push("Response: " + rsp.responseText); 
      ar.push("Argument object: " + rsp.argument); 
      alert(ar.join('\n'));
    }
  } 
}

function saveFail() {
  alert("Save failed\nPlease wait a moment and try again.");
}

function goSave() {
  var email = getValue('contact_email');
  if (email) {
    var url = "put";
    var callback = { 
      success:saveOk, 
      failure:saveFail,
      argument: [url]
    }; 
    var json = outputJSON();
    var request = YAHOO.util.Connect.asyncRequest('POST', url, callback, 
      'email=' + encodeURIComponent(email) +  '&json=' + encodeURIComponent(json)); 
  }
}

function showCommit() {
  var it = _gel('committed');
  if (it) {
    var btn = _gel('commit');
    if (btn) {
      btn.style.display = (it.value == "1" ? 'none' : 'block');
      var tos = _gel('tos');
      if (tos) {
        btn.disabled = (email_verified && tos.checked ? false : true);
        btn.enabled = !btn.disabled;
      }
    }
    var adv = _gel('commit_advice');
    if (adv) {
      adv.style.display = (it.value == "1" ? 'block' : 'none');
    }
    var adv = _gel('submit_advice');
    if (adv) {
      adv.style.display = (it.value == "1" ? 'none' : 'block');
    }
  }
}

function goCommit() {
  var it = _gel('committed');
  if (it) {
    it.value = "1";
  }
  showCommit();
  goSave();
}

function showTOS() {
  var it = _gel('tos');
  if (it) {
    var inp = _gel('committed');
    if (inp) {
      inp.value = (it.checked ? inp.value : "0");
    }
  }
  showCommit();
}

function goTOS(it) {
  showTOS();
  goSave();
}

var email_verified = null;
function goEmail(it) {
  if (it && it.value) {
    var email = it.value;
    if (email != email_verified) {
      var vmail = prompt('Please verify email');
      if (vmail != email) {
        alert('Please enter correct email address');
        email_verified = null;
      } else {
        email_verified = email;
        makeTable("get?email=" + encodeURIComponent(email));
        CHANGED = true;
        toggleSave();
      }
    }
  }
}

function chkEmail(inp) {
  if (!email_verified) {
    var it = _gel('contact_email');
    if (it) {
      it.focus();
      it.select();
    }
  }
}

function goBookmark(it) {
  var title = 'AllforGood Volunteer Opportunities';
  var url = location.href;
  if (window.sidebar) { // Mozilla Firefox Bookmark
    window.sidebar.addPanel(title, url, '');
  } else if (window.external) { // IE Favorite
    window.external.AddFavorite(url, title); 
  } else if (window.opera && window.print) { // Opera Hotlist
    alert('Press CTRL-T (Opera) to bookmark');
  }
}

function init() {
  var email_arg = (YAHOO.util.History.getQueryStringParameter('email') || '');
  email_verified = email_arg;
  makeTable("get?email=" + encodeURIComponent(email_arg));
  //setTimeout(function(){goSave();}, 60 * 1000);
}
YAHOO.util.Event.addListener(window, "load", function(){init();});
</script>
</body>
