{% extends "base_content_min.html" %}
{% block head %}
{% block js_files %}
<script type='text/javascript'>
  var vol = {};  // Namespace for calendar
</script>
{# can't combine with other JS, because that would go through a proxy, breaking IP-base location sniffing #}
<script src='http://www.google.com/jsapi?key={{ maps_api_key }}' type='text/javascript'></script>
<script type='text/javascript' src='/zx{{version}}/js/third_party/jquery-1.3.2.min.js'></script>
<script type='text/javascript' src='/zx{{version}}/js/third_party/jquery.json-1.3.min.js'></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script type='text/javascript' src='/zx{{version}}/js/third_party/rsh.js'></script>
<script type='text/javascript' src='/zx{{version}}/js/third_party/jquery.simplemodal.js'></script>
<script type='text/javascript' src='http://s7.addthis.com/js/250/addthis_widget.js'></script>
<script type='text/javascript' src='/zx{{version}}/js/utils.js'></script>
<script type='text/javascript' src='/zx{{version}}/js/search_query.js'></script>
{# not required for all pages, but harmless and simpler (for development only) #}
<script type='text/javascript' src='/zx{{version}}/js/homepage.js'></script>
<script type='text/javascript' src='http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php'></script>
<script type='text/javascript' src='http://li67-22.members.linode.com/~footprint/pipeline_common.js'></script>
<script type='text/javascript'>
  // Set pubId for AddThis
  addthis_pub = 'footprint2009dev';

  // These components load asynchronously.  We use AsyncLoadManager to
  // queue up function callbacks until each component is loaded.
  var asyncLoadManager = new AsyncLoadManager(
      [ 'map', 'bodyload', 'friendconnect' ]
  );

  // ...and one to queue JS callbacks on body unload event.
  var onUnloadWorkQueue = new WorkQueue();
  var currentPageName = '{{ current_page|escape }}';
</script>
{# functions for loading google analytics #}
<script type="text/javascript">
  function loadGA() {
          $.getScript('/zx{{version}}/js/third_party/ga.js');
  }
  function callGA(){
    if (typeof _gat != "undefined") {
      pageTracker = _gat._getTracker('{{ ga_key }}');
      //custom cookie timeout at 30min - also set in custom ga.js
      pageTracker._setCookieTimeout(30);
      pageTracker._trackPageview();
    } else {
      $.get('/google_analytics_error');
    }
}
</script>
{% endblock %}
{% block css_files %}
<link rel="stylesheet" type="text/css" href="/zx{{version}}/css/jquery.autocomplete.css" />
{% endblock %}
{% endblock %}{# head #}

{% block body %}
<body onload='asyncLoadManager.doneLoading("bodyload");'>  
<!--#wrapper-->
<div id="wrapper">
{% include 'content_header.html' %}
{% block subheader %}{% endblock %}
    <!--#main-->
    <div id="main" class="clearfix main-home">
{% include 'nav.html' %}
{{ static_content }}
{% block prefooter %}{% endblock %}
{% block footer %}{% include 'footer_home.html' %}{% endblock %}
    </div>
    <!--#main-->
</div>
<!--#wrapper-->

<div id='debug_snippets' style='display:none;'></div>
<script type='text/javascript'>
  ensureSubmitForm();
  if (currentPageName != 'HOMEPAGE') {
    createExampleSearchText();
  }
  setInputFieldValue(el('keywords'), '');
</script>

{# setup google analytics on static pages #}
{% ifequal current_page 'STATIC_PAGE' %}
  {% ifnotequal ga_key 'unknown' %}
    <script type="text/javascript">
       // Load analytics on static pages only, done in homepage.js for
       // the homepage and search_results.js for search pages.
      loadGA();
    </script>
  {% endifnotequal %}
{% endifequal %}

{# setup autocomplete last #}
<script type='text/javascript' src='/zx{{version}}/js/third_party/jquery.autocomplete.js'></script>
<script>
  $("#keywords").autocomplete("/autocomplete/query");
</script>
</body>
{% endblock %}
